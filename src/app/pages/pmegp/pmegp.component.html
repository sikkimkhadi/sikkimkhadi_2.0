@if (pmegpData$ | async; as pmegpData) {
  <!-- Hero Section -->
  <section class="hero-section">
      <div class="hero-overlay">
        <div class="container">
          <div class="hero-content">
            <div class="hero-logo">
              <img src="/assets/pmegp/amm.png" alt="Azadi Ka Amrit Mahotsav" class="azadi-logo">
            </div>
            <h1 class="hero-title">{{ pmegpData.title }}</h1>
            <p class="hero-subtitle">{{ pmegpData.subtitle }}</p>
            <p class="hero-description">{{ pmegpData.description }}</p>
          </div>
        </div>
      </div>
    </section>

  <!-- Statistics Section -->
  @if (pmegpData$ | async; as data) {
    <section class="statistics-section">
      <div class="container">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number">{{ data.totalProjects }}</div>
            <div class="stat-label">Total Projects</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">{{ data.totalSanctioned }}</div>
            <div class="stat-label">Projects Sanctioned</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">₹{{ data.totalValue }}</div>
            <div class="stat-label">Total Value (Lakhs)</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">₹{{ data.totalSubsidy }}</div>
            <div class="stat-label">Total Subsidy (Lakhs)</div>
          </div>
        </div>
      </div>
    </section>
  }

  <!-- Carousel Section -->
  <section class="carousel-section">
    <div class="container">
      <h2 class="section-title">PMEGP in Action</h2>
      <p class="section-subtitle">Empowering entrepreneurs across Sikkim</p>
      <div class="carousel-wrapper">
        @if (isLargeScreen | async) {
          <!-- Desktop/Tablet carousel -->
          <app-pmegp-cl-desk />
        } @else {
          <!-- Mobile carousel -->
          <app-pmegp-cl-mob />
        }
      </div>
    </div>
  </section>

  <!-- Performance Table Section -->
  @if (performanceData$ | async; as performanceData) {
    <section class="performance-section">
      <div class="container">
        <h2 class="section-title">PMEGP Performance by SKVIB</h2>
        <p class="section-subtitle">A comprehensive overview of our achievements</p>
        
        <!-- Desktop Table -->
        <div class="table-container desktop-table">
          <table class="performance-table">
            <thead>
              <tr>
                <th>Year</th>
                <th>Projects Received</th>
                <th>Projects Sanctioned</th>
                <th>Total Value (₹ Lakhs)</th>
                <th>Total Subsidy (₹ Lakhs)</th>
              </tr>
            </thead>
            <tbody>
              @for (data of performanceData; track trackByYear($index, data)) {
                <tr>
                  <td class="year-cell">{{ data.year }}</td>
                  <td>{{ data.projectsReceived }}</td>
                  <td>{{ data.projectsSanctioned }}</td>
                  <td>{{ data.totalValue }}</td>
                  <td>{{ data.totalSubsidy }}</td>
                </tr>
              }
            </tbody>
          </table>
        </div>
        
        <!-- Mobile Cards -->
        <div class="mobile-cards">
          @for (data of performanceData; track trackByYear($index, data)) {
            <div class="performance-card">
              <div class="card-header">
                <h3>{{ data.year }}</h3>
              </div>
              <div class="card-content">
                <div class="metric">
                  <span class="metric-label">Projects Received</span>
                  <span class="metric-value">{{ data.projectsReceived }}</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Projects Sanctioned</span>
                  <span class="metric-value">{{ data.projectsSanctioned }}</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Total Value</span>
                  <span class="metric-value">₹{{ data.totalValue }} Lakhs</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Total Subsidy</span>
                  <span class="metric-value">₹{{ data.totalSubsidy }} Lakhs</span>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    </section>
  }

  <!-- Objectives Section -->
  @if (objectives$ | async; as objectives) {
    <section class="objectives-section">
      <div class="container">
        <h2 class="section-title">Objectives of the Scheme</h2>
        <p class="section-subtitle">Our mission to empower entrepreneurs</p>
        
        <div class="objectives-grid">
          @for (objective of objectives; track trackByObjectiveId($index, objective)) {
            <div class="objective-card">
              <div class="objective-number">{{ objective.id }}</div>
              <h3 class="objective-title">{{ objective.title }}</h3>
              <p class="objective-description">{{ objective.description }}</p>
            </div>
          }
        </div>
      </div>
    </section>


  }

  <!-- Content Sections -->
  @if (sections$ | async; as sections) {
    <section class="content-sections">
      <div class="container">
        @for (section of sections; track trackBySectionId($index, section)) {
          <div class="content-section">
            <h2 class="content-title">{{ section.title }}</h2>
            
            @for (contentItem of section.content; track $index) {
              @if (contentItem.type === 'paragraph') {
                <p class="content-text" [innerHTML]="contentItem.text"></p>
              } @else if (contentItem.type === 'list') {
                @if (contentItem.text) {
                  <p class="content-intro">{{ contentItem.text }}</p>
                }
                <ul class="content-list">
                  @for (item of contentItem.items; track item) {
                    <li>{{ item }}</li>
                  }
                </ul>
              } @else if (contentItem.type === 'ordered-list') {
                @if (contentItem.text) {
                  <p class="content-intro">{{ contentItem.text }}</p>
                }
                <ol class="content-ordered-list">
                  @for (item of contentItem.items; track item) {
                    <li>{{ item }}</li>
                  }
                </ol>
              } @else if (contentItem.type === 'table' && contentItem.tableHeaders && contentItem.tableRows) {
                <div class="content-table-wrapper">
                  <table class="content-table">
                    <thead>
                      <tr>
                        <th rowspan="2">{{ contentItem.tableHeaders[0] }}</th>
                        <th rowspan="2">{{ contentItem.tableHeaders[1] }}</th>
                        <th [attr.colspan]="2">{{ contentItem.tableHeaders[2] }}</th>
                      </tr>
                      <tr>
                        <!-- Empty cells for URBAN and RURAL will be filled by subheader row -->
                      </tr>
                    </thead>
                    <tbody>
                      @for (row of contentItem.tableRows; track row) {
                        <tr [class.subheader-row]="row.isHeaderRow">
                          <td [class.table-subheader]="row.isHeaderRow">{{ row.category }}</td>
                          <td [class.table-subheader]="row.isHeaderRow">{{ row.beneficiaryContribution }}</td>
                          <td [class.table-subheader]="row.isHeaderRow">{{ row.rateOfSubsidy?.urban }}</td>
                          <td [class.table-subheader]="row.isHeaderRow">{{ row.rateOfSubsidy?.rural }}</td>
                        </tr>
                      }
                    </tbody>
                  </table>
                </div>
              }
            }
          </div>
        }
      </div>
    </section>
  }

  <!-- Call to Action Section -->
  <section class="cta-section">
    <div class="container">
      <div class="cta-content">
        <h2 class="cta-title">Ready to Start Your Enterprise?</h2>
        <p class="cta-description">Join the PMEGP program and turn your business ideas into reality with government support.</p>
        <div class="cta-buttons">
          <a [routerLink]="['/contact']" class="cta-button primary">
            Apply Now
            <span class="material-symbols-outlined">arrow_forward</span>
          </a>
          <a [routerLink]="['/outlets']" class="cta-button secondary">
            Visit Outlets
            <span class="material-symbols-outlined">location_on</span>
          </a>
        </div>
      </div>
    </div>
  </section>
}

<!-- Loading State -->
@if (loading()) {
  <div class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading PMEGP information...</p>
  </div>
}

<!-- Error State -->
@if (error()) {
  <div class="error-container">
    <div class="error-icon">⚠️</div>
    <h2 class="error-title">Failed to Load</h2>
    <p class="error-description">{{ error() }}</p>
    <button class="error-button" (click)="loadPMEGPData()">
      Try Again
      <span class="material-symbols-outlined">refresh</span>
    </button>
  </div>
}